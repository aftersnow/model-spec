{
    "description": "Model Artifact Configuration Schema",
    "$schema": "http://json-schema.org/draft-04/schema#",
    "$id": "https://github.com/modelpack/model-spec/config",
    "type": "object",
    "properties": {
      "descriptor": {
        "$ref": "#/$defs/ModelDescriptor"
      },
      "modelfs": {
        "$ref": "#/$defs/ModelFS"
      },
      "config": {
        "$ref": "#/$defs/ModelConfig"
      }
    },
    "additionalProperties": false,
    "required": [
      "descriptor",
      "config",
      "modelfs"
    ],
    "$defs": {
      "ModelConfig": {
        "type": "object",
        "properties": {
          "architecture": {
            "type": "string",
            "enum": ["transformer", "cnn", "rnn", "lstm", "gru", "bert", "gpt", "resnet", "vit", "gan", "vae", "diffusion", "other"]
          },
          "format": {
            "type": "string",
            "enum": ["onnx", "safetensors", "gguf", "pt", "pytorch", "tensorflow", "tf", "tflite", "coreml", "openvino", "other"]
          },
          "paramSize": {
            "type": "string",
            "pattern": "^\\d+(\\.\\d)?[qQtTbBmMkK]$"
          },
          "precision": {
            "type": "string",
            "pattern": "^(float32|float64|float16|bfloat16|float8_e4m3|float8_e5m2|complex32|complex64|complex128|int8|int16|int32|int64|uint8|uint16|uint32|uint64|bool|mixed|fp32|fp16|bf16|fp8|int4|fp64)(,(float32|float64|float16|bfloat16|float8_e4m3|float8_e5m2|complex32|complex64|complex128|int8|int16|int32|int64|uint8|uint16|uint32|uint64|bool|mixed|fp32|fp16|bf16|fp8|int4|fp64))*$"
          },
          "quantization": {
            "type": "string",
            "enum": ["awq", "gptq", "gguf", "bnb", "int8", "int4", "nf4", "fp4", "other"]
          },
          "capabilities": {
            "$ref": "#/$defs/ModelCapabilities"
          }
        },
        "additionalProperties": false
      },
      "ModelDescriptor": {
        "type": "object",
        "properties": {
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "authors": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "family": {
            "type": "string"
          },
          "name": {
            "type": "string",
            "minLength": 1
          },
          "docURL": {
            "type": "string",
            "format": "uri"
          },
          "sourceURL": {
            "type": "string",
            "format": "uri"
          },
          "version": {
            "type": "string"
          },
          "revision": {
            "type": "string"
          },
          "vendor": {
            "type": "string"
          },
          "licenses": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          }
        },
        "additionalProperties": false
      },
      "ModelFS": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["layers"]
          },
          "diffIds": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "minItems": 1
          }
        },
        "additionalProperties": false,
        "required": [
          "type",
          "diffIds"
        ]
      },
      "ModelCapabilities": {
        "type": "object",
        "properties": {
          "inputTypes": {
            "type": "array",
            "items": {
               "$ref": "#/$defs/Modality"
            }
          },
          "outputTypes": {
            "type": "array",
            "items": {
              "$ref": "#/$defs/Modality"
            }
          },
          "knowledgeCutoff": {
            "type": "string",
            "format": "date-time"
          },
          "reasoning": {
            "type": "boolean"
          },
          "toolUsage": {
            "type": "boolean"
          },
          "embedding": {
            "type": "boolean"
          },
          "reward": {
            "type": "boolean"
          }
        }
      },
      "Modality": {
        "type": "string",
        "enum": ["text", "image", "audio", "video", "embedding", "other"]
      }
  }
}
